<header class="page-header">
  <div class="header-content">
    <div class="header-left">
      <h1 class="page-title">ðŸ’° Enhanced Payroll Management System</h1>
      <p class="page-subtitle">Manage employee payroll, salary calculations, and payment processing</p>
    </div>
    <div class="header-right">
      <div class="nav-buttons">
        <button class="nav-btn home" routerLink="/home">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
            <polyline points="9,22 9,12 15,12 15,22"/>
          </svg>
          Home
        </button>
        <button class="nav-btn back" (click)="goBack()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back
        </button>
      </div>
      <div class="user-info">
        <div class="user-avatar">A</div>
        <div class="user-details">
          <span class="user-name">Admin User</span>
          <span class="user-role">ADMINISTRATOR</span>
        </div>
      </div>
      <button class="logout-btn" (click)="logout()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
          <polyline points="16,17 21,12 16,7"/>
          <line x1="21" y1="12" x2="9" y2="12"/>
        </svg>
        Logout
      </button>
    </div>
  </div>
</header>

<!-- Stats Cards -->
<section class="stats-section">
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">ðŸ‘¥</div>
      <div class="stat-content">
        <h3>{{ payrolls.length }}</h3>
        <p>Total Payrolls</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">ðŸ’°</div>
      <div class="stat-content">
        <h3>â‚¹{{ getTotalNetSalary() | number }}</h3>
        <p>Total Net Salary</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">ðŸ“Š</div>
      <div class="stat-content">
        <h3>â‚¹{{ getAverageSalary() | number }}</h3>
        <p>Average Salary</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">ðŸ“ˆ</div>
      <div class="stat-content">
        <h3>{{ getUniqueEmployees() }}</h3>
        <p>Active Employees</p>
      </div>
    </div>
  </div>
</section>

<!-- Main Content -->
<main class="main-content">
  <div class="content-card">
    <div class="card-header">
      <h2>ðŸ“‹ Payroll Records</h2>
      <div class="header-actions">
        <button class="action-btn primary" (click)="generatePayroll()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12l7-7 7 7"/>
          </svg>
          Generate Payroll
        </button>
        <button class="action-btn" (click)="exportPayroll()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7,10 12,15 17,10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          Export Data
        </button>
      </div>
    </div>

    <div class="table-container">
      <table class="payroll-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Employee</th>
            <th>Month</th>
            <th>Basic Salary</th>
            <th>Allowance</th>
            <th>Deductions</th>
            <th>Net Salary</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of payrolls; trackBy: trackByPayrollId" class="payroll-row">
            <td class="payroll-id">{{ p.id }}</td>
            <td class="employee-name">
              <div class="employee-info">
                <div class="employee-avatar">
                  <span>{{ p.employee.charAt(0) }}</span>
                </div>
                <span>{{ p.employee }}</span>
              </div>
            </td>
            <td class="month">{{ p.month }}</td>
            <td class="basic-salary">â‚¹{{ p.basic | number }}</td>
            <td class="allowance">â‚¹{{ p.allowance | number }}</td>
            <td class="deductions">â‚¹{{ p.deductions | number }}</td>
            <td class="net-salary">
              <span class="salary-amount">â‚¹{{ p.netSalary | number }}</span>
            </td>
            <td class="status">
              <span class="status-badge paid">Paid</span>
            </td>
            <td class="actions">
              <button class="action-btn download" (click)="downloadSlip(p)" title="Download Salary Slip">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7,10 12,15 17,10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
              </button>
              <button class="action-btn view" (click)="viewPayroll(p)" title="View Details">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                  <circle cx="12" cy="12" r="3"/>
                </svg>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</main>

<!-- Payroll Details Modal -->
<div class="modal-overlay" *ngIf="showPayrollModal" (click)="closePayrollModal()">
  <div class="modal-content" (click)="$event.stopPropagation()" *ngIf="selectedPayroll">
    <div class="modal-header">
      <h3>ðŸ’° Payroll Details</h3>
      <button class="modal-close" (click)="closePayrollModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
    
    <div class="modal-body">
      <div class="employee-section">
        <div class="employee-header">
          <div class="employee-avatar-large">
            <span>{{ selectedPayroll.employee.charAt(0) }}</span>
          </div>
          <div class="employee-info">
            <h4>{{ selectedPayroll.employee }}</h4>
            <p class="employee-id">Employee ID: EMP{{ selectedPayroll.id.toString().padStart(4, '0') }}</p>
            <p class="employee-department">{{ selectedPayroll.department || 'General Department' }}</p>
          </div>
        </div>
      </div>
      
      <div class="payroll-details">
        <div class="detail-section">
          <h5>ðŸ“… Pay Period Information</h5>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">Pay Period:</span>
              <span class="detail-value">{{ selectedPayroll.month }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Generated Date:</span>
              <span class="detail-value">{{ getCurrentDate() }}</span>
            </div>
          </div>
        </div>
        
        <div class="detail-section">
          <h5>ðŸ“§ Contact Information</h5>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">Email:</span>
              <span class="detail-value">{{ selectedPayroll.email || 'N/A' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Phone:</span>
              <span class="detail-value">{{ selectedPayroll.phone || 'N/A' }}</span>
            </div>
          </div>
        </div>
        
        <div class="detail-section">
          <h5>ðŸ’° Salary Breakdown</h5>
          <div class="salary-breakdown">
            <div class="salary-item">
              <span class="salary-label">Basic Salary:</span>
              <span class="salary-amount positive">â‚¹{{ selectedPayroll.basic | number }}</span>
            </div>
            <div class="salary-item">
              <span class="salary-label">Allowances:</span>
              <span class="salary-amount positive">â‚¹{{ selectedPayroll.allowance | number }}</span>
            </div>
            <div class="salary-item">
              <span class="salary-label">Gross Salary:</span>
              <span class="salary-amount positive">â‚¹{{ (selectedPayroll.basic + selectedPayroll.allowance) | number }}</span>
            </div>
            <div class="salary-item">
              <span class="salary-label">Deductions:</span>
              <span class="salary-amount negative">-â‚¹{{ selectedPayroll.deductions | number }}</span>
            </div>
            <div class="salary-item total">
              <span class="salary-label">Net Salary:</span>
              <span class="salary-amount total">â‚¹{{ selectedPayroll.netSalary | number }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="modal-footer">
      <button class="modal-btn secondary" (click)="closePayrollModal()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
        Close
      </button>
      <button class="modal-btn primary" (click)="downloadSlip(selectedPayroll)">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7,10 12,15 17,10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
        Download Slip
      </button>
    </div>
  </div>
</div>
