<header class="page-header">
  <div class="header-content">
    <div class="header-left">
      <h1 class="page-title">📅 Enhanced Attendance Management System</h1>
      <p class="page-subtitle">Track employee attendance, punctuality, and performance metrics</p>
    </div>
    <div class="header-right">
      <div class="nav-buttons">
        <button class="nav-btn home" routerLink="/home">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
            <polyline points="9,22 9,12 15,12 15,22"/>
          </svg>
          Home
        </button>
        <button class="nav-btn back" (click)="goBack()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back
        </button>
      </div>
      <div class="user-info">
        <div class="user-avatar">{{ currentUser?.name?.charAt(0) || 'A' }}</div>
        <div class="user-details">
          <span class="user-name">{{ currentUser?.name || 'Admin User' }}</span>
          <span class="user-role">{{ currentUser?.role?.toUpperCase() || 'ADMINISTRATOR' }}</span>
        </div>
      </div>
      <button class="logout-btn" (click)="logout()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
          <polyline points="16,17 21,12 16,7"/>
          <line x1="21" y1="12" x2="9" y2="12"/>
        </svg>
        Logout
      </button>
    </div>
  </div>
</header>

<!-- Main Content -->
<main class="main-content">
  <!-- Stats Cards -->
  <section class="stats-section">
    <div class="stats-grid">
      <div class="stat-card" data-aos="fade-up" data-aos-delay="100">
        <div class="stat-icon present-days-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 12l2 2 4-4"/>
            <circle cx="12" cy="12" r="10"/>
          </svg>
          <div class="icon-bg"></div>
        </div>
        <div class="stat-content">
          <h3 class="stat-number counter">{{ getTotalPresentDays() }}</h3>
          <p class="stat-label">Total Present Days</p>
          <div class="stat-trend positive">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23,6 13.5,15.5 8.5,10.5 1,18"/>
              <polyline points="17,6 23,6 23,12"/>
            </svg>
            <span>+12% this month</span>
          </div>
        </div>
      </div>
      
      <div class="stat-card" data-aos="fade-up" data-aos-delay="200">
        <div class="stat-icon absent-days-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="15" y1="9" x2="9" y2="15"/>
            <line x1="9" y1="9" x2="15" y2="15"/>
          </svg>
          <div class="icon-bg"></div>
        </div>
        <div class="stat-content">
          <h3 class="stat-number counter">{{ getTotalAbsentDays() }}</h3>
          <p class="stat-label">Total Absent Days</p>
          <div class="stat-trend negative">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23,18 13.5,8.5 8.5,13.5 1,6"/>
              <polyline points="17,18 23,18 23,12"/>
            </svg>
            <span>-8% from last month</span>
          </div>
        </div>
      </div>
      
      <div class="stat-card" data-aos="fade-up" data-aos-delay="300">
        <div class="stat-icon overtime-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12,6 12,12 16,14"/>
          </svg>
          <div class="icon-bg"></div>
        </div>
        <div class="stat-content">
          <h3 class="stat-number counter">{{ getTotalOvertimeHours() }}h</h3>
          <p class="stat-label">Total Overtime Hours</p>
          <div class="stat-trend positive">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23,6 13.5,15.5 8.5,10.5 1,18"/>
              <polyline points="17,6 23,6 23,12"/>
            </svg>
            <span>+25% this month</span>
          </div>
        </div>
      </div>
      
      <div class="stat-card" data-aos="fade-up" data-aos-delay="400">
        <div class="stat-icon average-attendance-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
          <div class="icon-bg"></div>
        </div>
        <div class="stat-content">
          <h3 class="stat-number counter">{{ getAverageAttendancePercentage() | number:'1.1-1' }}%</h3>
          <p class="stat-label">Average Attendance</p>
          <div class="stat-trend positive">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23,6 13.5,15.5 8.5,10.5 1,18"/>
              <polyline points="17,6 23,6 23,12"/>
            </svg>
            <span>+3% improvement</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Analytics Dashboard -->
  <section class="analytics-section">
    <div class="analytics-header">
      <h2 class="analytics-title">📊 Attendance Analytics</h2>
      <p class="analytics-subtitle">Comprehensive insights into attendance patterns and trends</p>
    </div>
    
    <div class="charts-grid">
      <!-- Status Distribution Chart -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>Performance Status</h3>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
        </div>
        <div class="chart-content">
          <div class="pie-chart">
            <div class="pie-slice" *ngFor="let status of getAttendanceByStatus()" 
                 [style.--percentage]="(status.count / records.length) * 100 + '%'"
                 [style.--color]="status.color">
              <div class="slice-fill"></div>
            </div>
          </div>
          <div class="chart-legend">
            <div class="legend-item" *ngFor="let status of getAttendanceByStatus()">
              <div class="legend-color" [style.background-color]="status.color"></div>
              <span class="legend-label">{{ status.status }}</span>
              <span class="legend-value">{{ status.count }} ({{ (status.count / records.length) * 100 | number:'1.0-1' }}%)</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Department Distribution Chart -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>Department Distribution</h3>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
            <polyline points="9,22 9,12 15,12 15,22"/>
          </svg>
        </div>
        <div class="chart-content">
          <div class="bar-chart">
            <div class="bar-item" *ngFor="let dept of getAttendanceByDepartment()">
              <div class="bar-label">{{ dept.department }}</div>
              <div class="bar-container">
                <div class="bar-fill" [style.width.%]="(dept.count / records.length) * 100"></div>
                <span class="bar-value">{{ dept.count }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Top Performers -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>Top Performers</h3>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 12l2 2 4-4"/>
            <circle cx="12" cy="12" r="10"/>
          </svg>
        </div>
        <div class="chart-content">
          <div class="top-performers">
            <div class="performer-item" *ngFor="let performer of getTopPerformers(); let i = index">
              <div class="performer-rank">{{ i + 1 }}</div>
              <div class="performer-avatar">
                <img [src]="performer.employeePhoto" [alt]="performer.employeeName" class="performer-photo"
                     (error)="handleImageError($event)">
                <div class="performer-fallback" style="display: none;">{{ performer.employeeName.charAt(0) }}</div>
              </div>
              <div class="performer-info">
                <div class="performer-name">{{ performer.employeeName }}</div>
                <div class="performer-department">{{ performer.department }}</div>
              </div>
              <div class="performer-attendance">
                <span class="attendance-value">{{ performer.attendancePercentage | number:'1.1-1' }}%</span>
                <span class="attendance-status" 
                      [class.excellent]="performer.status === 'Excellent'"
                      [class.good]="performer.status === 'Good'"
                      [class.average]="performer.status === 'Average'"
                      [class.poor]="performer.status === 'Poor'">
                  {{ performer.status }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Average Attendance by Department -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>Average Attendance by Department</h3>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
            <line x1="8" y1="21" x2="16" y2="21"/>
            <line x1="12" y1="17" x2="12" y2="21"/>
          </svg>
        </div>
        <div class="chart-content">
          <div class="average-chart">
            <div class="average-item" *ngFor="let avg of getAverageAttendanceByDepartment()">
              <div class="average-label">{{ avg.department }}</div>
              <div class="average-bar">
                <div class="average-fill" 
                     [style.width.%]="(avg.averageAttendance / getMaxAverageAttendance()) * 100"></div>
              </div>
              <div class="average-value">{{ avg.averageAttendance }}%</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Attendance Management -->
  <section class="attendance-section">
    <div class="section-header">
      <h2 class="section-title">Attendance Records</h2>
      <button class="add-btn" (click)="addAttendance()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
        Add Record
      </button>
    </div>

    <!-- Search and Filter Controls -->
    <div class="controls-section">
      <div class="search-container">
        <div class="search-input-wrapper">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35"/>
          </svg>
          <input 
            type="text" 
            [(ngModel)]="searchTerm" 
            placeholder="Search attendance by employee, department, or ID..."
            class="search-input"
          >
          <div class="search-glow"></div>
        </div>
      </div>
      
      <div class="filter-controls">
        <div class="filter-group">
          <label>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
              <line x1="16" y1="2" x2="16" y2="6"/>
              <line x1="8" y1="2" x2="8" y2="6"/>
              <line x1="3" y1="10" x2="21" y2="10"/>
            </svg>
            Month
          </label>
          <select [(ngModel)]="selectedMonth" class="filter-select">
            <option *ngFor="let month of months" [value]="month">{{ month }}</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
              <line x1="16" y1="2" x2="16" y2="6"/>
              <line x1="8" y1="2" x2="8" y2="6"/>
              <line x1="3" y1="10" x2="21" y2="10"/>
            </svg>
            Year
          </label>
          <select [(ngModel)]="selectedYear" class="filter-select">
            <option *ngFor="let year of years" [value]="year">{{ year }}</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
            Status
          </label>
          <select [(ngModel)]="selectedStatus" class="filter-select">
            <option *ngFor="let status of statuses" [value]="status">{{ status }}</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
              <polyline points="9,22 9,12 15,12 15,22"/>
            </svg>
            Department
          </label>
          <select [(ngModel)]="selectedDepartment" class="filter-select">
            <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
          </select>
        </div>
        
        <button class="clear-btn" (click)="clearFilters()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
          Clear Filters
        </button>
      </div>
      
      <!-- Results Info -->
      <div class="results-info" *ngIf="searchTerm || selectedMonth !== 'All' || selectedYear !== 'All' || selectedStatus !== 'All' || selectedDepartment !== 'All'">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/>
          <path d="M21 21l-4.35-4.35"/>
        </svg>
        <span>Showing {{ filteredRecords.length }} of {{ records.length }} records</span>
      </div>
    </div>

    <div class="table-container">
      <table class="attendance-table">
    <thead>
      <tr>
            <th (click)="sortRecords('id')" class="sortable">
              Record ID
              <svg *ngIf="sortBy === 'id'" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path *ngIf="sortOrder === 'asc'" d="M12 5l-7 7h14l-7-7z"/>
                <path *ngIf="sortOrder === 'desc'" d="M12 19l7-7H5l7 7z"/>
              </svg>
            </th>
            <th (click)="sortRecords('employeeName')" class="sortable">
              Employee
              <svg *ngIf="sortBy === 'employeeName'" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path *ngIf="sortOrder === 'asc'" d="M12 5l-7 7h14l-7-7z"/>
                <path *ngIf="sortOrder === 'desc'" d="M12 19l7-7H5l7 7z"/>
              </svg>
            </th>
            <th (click)="sortRecords('department')" class="sortable">
              Department
              <svg *ngIf="sortBy === 'department'" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path *ngIf="sortOrder === 'asc'" d="M12 5l-7 7h14l-7-7z"/>
                <path *ngIf="sortOrder === 'desc'" d="M12 19l7-7H5l7 7z"/>
              </svg>
            </th>
            <th>Period</th>
            <th (click)="sortRecords('presentDays')" class="sortable">
              Present
              <svg *ngIf="sortBy === 'presentDays'" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path *ngIf="sortOrder === 'asc'" d="M12 5l-7 7h14l-7-7z"/>
                <path *ngIf="sortOrder === 'desc'" d="M12 19l7-7H5l7 7z"/>
              </svg>
            </th>
            <th (click)="sortRecords('absentDays')" class="sortable">
              Absent
              <svg *ngIf="sortBy === 'absentDays'" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path *ngIf="sortOrder === 'asc'" d="M12 5l-7 7h14l-7-7z"/>
                <path *ngIf="sortOrder === 'desc'" d="M12 19l7-7H5l7 7z"/>
              </svg>
            </th>
            <th (click)="sortRecords('leaveDays')" class="sortable">
              Leave
              <svg *ngIf="sortBy === 'leaveDays'" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path *ngIf="sortOrder === 'asc'" d="M12 5l-7 7h14l-7-7z"/>
                <path *ngIf="sortOrder === 'desc'" d="M12 19l7-7H5l7 7z"/>
              </svg>
            </th>
            <th (click)="sortRecords('attendancePercentage')" class="sortable">
              Attendance %
              <svg *ngIf="sortBy === 'attendancePercentage'" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path *ngIf="sortOrder === 'asc'" d="M12 5l-7 7h14l-7-7z"/>
                <path *ngIf="sortOrder === 'desc'" d="M12 19l7-7H5l7 7z"/>
              </svg>
            </th>
            <th (click)="sortRecords('status')" class="sortable">
              Status
              <svg *ngIf="sortBy === 'status'" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path *ngIf="sortOrder === 'asc'" d="M12 5l-7 7h14l-7-7z"/>
                <path *ngIf="sortOrder === 'desc'" d="M12 19l7-7H5l7 7z"/>
              </svg>
            </th>
            <th>Actions</th>
      </tr>
    </thead>
    <tbody>
          <tr *ngFor="let record of filteredRecords">
            <td class="att-id">{{ record.id }}</td>
            <td class="att-employee">
              <div class="employee-cell">
                <div class="avatar">
                  <img [src]="record.employeePhoto" [alt]="record.employeeName" class="employee-photo" 
                       (error)="handleImageError($event)">
                  <div class="avatar-fallback" style="display: none;">{{ record.employeeName.charAt(0) }}</div>
                </div>
                <div class="employee-info">
                  <span class="employee-name">{{ record.employeeName }}</span>
                  <span class="employee-id">{{ record.employeeId }}</span>
                </div>
              </div>
            </td>
            <td>{{ record.department }}</td>
            <td class="period">{{ record.month }} {{ record.year }}</td>
            <td class="present-days">{{ record.presentDays }}</td>
            <td class="absent-days">{{ record.absentDays }}</td>
            <td class="leave-days">{{ record.leaveDays }}</td>
            <td class="attendance-percentage">{{ record.attendancePercentage | number:'1.1-1' }}%</td>
            <td>
              <span class="status-badge" 
                    [class.excellent]="record.status === 'Excellent'" 
                    [class.good]="record.status === 'Good'" 
                    [class.average]="record.status === 'Average'" 
                    [class.poor]="record.status === 'Poor'">
                {{ record.status }}
              </span>
            </td>
            <td class="actions">
              <button class="action-btn view" (click)="viewAttendance(record)">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                  <circle cx="12" cy="12" r="3"/>
                </svg>
                View
              </button>
              <button class="action-btn edit" (click)="editAttendance(record)">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                </svg>
                Edit
              </button>
              <button class="action-btn delete" (click)="deleteAttendance(record)">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3,6 5,6 21,6"/>
                  <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"/>
                </svg>
                Delete
              </button>
            </td>
      </tr>
    </tbody>
  </table>
    </div>
  </section>
</main>

<footer class="footer glass">
  <p>© 2025 PayGenie. All rights reserved.</p>
</footer>

<!-- Attendance Detail Modal -->
<div class="modal-overlay" *ngIf="selectedAttendance" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">Attendance Details</h3>
      <button class="modal-close" (click)="closeModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
    
    <div class="modal-body" *ngIf="selectedAttendance">
      <div class="attendance-profile">
        <div class="profile-avatar">
          <img [src]="selectedAttendance.employeePhoto" [alt]="selectedAttendance.employeeName" class="profile-photo"
               (error)="handleImageError($event)">
          <div class="profile-fallback" style="display: none;">{{ selectedAttendance.employeeName.charAt(0) }}</div>
        </div>
        <div class="profile-info">
          <h2 class="profile-name">{{ selectedAttendance.employeeName }}</h2>
          <p class="profile-department">{{ selectedAttendance.department }} • {{ selectedAttendance.employeeId }}</p>
          <p class="profile-period">{{ selectedAttendance.month }} {{ selectedAttendance.year }}</p>
          <div class="profile-metrics">
            <div class="metric">
              <span class="metric-label">Attendance Rate</span>
              <span class="metric-value">{{ selectedAttendance.attendancePercentage | number:'1.1-1' }}%</span>
            </div>
            <div class="metric">
              <span class="metric-label">Present Days</span>
              <span class="metric-value">{{ selectedAttendance.presentDays }}</span>
            </div>
            <div class="metric">
              <span class="metric-label">Overtime Hours</span>
              <span class="metric-value">{{ selectedAttendance.overtimeHours }}h</span>
            </div>
          </div>
        </div>
        <div class="profile-status">
          <span class="status-badge" 
                [class.excellent]="selectedAttendance.status === 'Excellent'" 
                [class.good]="selectedAttendance.status === 'Good'" 
                [class.average]="selectedAttendance.status === 'Average'" 
                [class.poor]="selectedAttendance.status === 'Poor'">
            {{ selectedAttendance.status }}
          </span>
        </div>
      </div>
      
      <div class="attendance-details-grid">
        <div class="detail-card">
          <div class="detail-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 12l2 2 4-4"/>
              <circle cx="12" cy="12" r="10"/>
            </svg>
          </div>
          <div class="detail-content">
            <h4>Present Days</h4>
            <p>{{ selectedAttendance.presentDays }} days</p>
          </div>
        </div>
        
        <div class="detail-card">
          <div class="detail-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="15" y1="9" x2="9" y2="15"/>
              <line x1="9" y1="9" x2="15" y2="15"/>
            </svg>
          </div>
          <div class="detail-content">
            <h4>Absent Days</h4>
            <p>{{ selectedAttendance.absentDays }} days</p>
          </div>
        </div>
        
        <div class="detail-card">
          <div class="detail-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
          </div>
          <div class="detail-content">
            <h4>Leave Days</h4>
            <p>{{ selectedAttendance.leaveDays }} days</p>
          </div>
        </div>
        
        <div class="detail-card">
          <div class="detail-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12,6 12,12 16,14"/>
            </svg>
          </div>
          <div class="detail-content">
            <h4>Overtime Hours</h4>
            <p>{{ selectedAttendance.overtimeHours }} hours</p>
          </div>
        </div>
        
        <div class="detail-card">
          <div class="detail-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12,6 12,12 16,14"/>
            </svg>
          </div>
          <div class="detail-content">
            <h4>Late Arrivals</h4>
            <p>{{ selectedAttendance.lateArrivals }} times</p>
          </div>
        </div>
        
        <div class="detail-card">
          <div class="detail-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12,6 12,12 16,14"/>
            </svg>
          </div>
          <div class="detail-content">
            <h4>Early Departures</h4>
            <p>{{ selectedAttendance.earlyDepartures }} times</p>
          </div>
        </div>
        
        <div class="detail-card">
          <div class="detail-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
              <line x1="16" y1="2" x2="16" y2="6"/>
              <line x1="8" y1="2" x2="8" y2="6"/>
              <line x1="3" y1="10" x2="21" y2="10"/>
            </svg>
          </div>
          <div class="detail-content">
            <h4>Last Attendance</h4>
            <p>{{ selectedAttendance.lastAttendanceDate }}</p>
          </div>
        </div>
        
        <div class="detail-card">
          <div class="detail-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
              <line x1="16" y1="2" x2="16" y2="6"/>
              <line x1="8" y1="2" x2="8" y2="6"/>
              <line x1="3" y1="10" x2="21" y2="10"/>
            </svg>
          </div>
          <div class="detail-content">
            <h4>Created Date</h4>
            <p>{{ selectedAttendance.createdAt }}</p>
          </div>
        </div>
        
        <div class="detail-card notes-card" *ngIf="selectedAttendance.notes">
          <div class="detail-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14,2 14,8 20,8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
              <polyline points="10,9 9,9 8,9"/>
            </svg>
          </div>
          <div class="detail-content">
            <h4>Notes</h4>
            <p>{{ selectedAttendance.notes }}</p>
          </div>
        </div>
      </div>
      
      <div class="modal-actions">
        <button class="modal-btn edit" (click)="editAttendance(selectedAttendance); closeModal()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
          </svg>
          Edit Record
        </button>
        <button class="modal-btn delete" (click)="deleteAttendance(selectedAttendance); closeModal()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3,6 5,6 21,6"/>
            <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"/>
          </svg>
          Delete Record
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Edit Attendance Modal -->
<div class="modal-overlay" *ngIf="showEditModal" (click)="closeEditModal()">
  <div class="modal-content edit-modal" (click)="$event.stopPropagation()" *ngIf="editingAttendance">
    <div class="modal-header">
      <h3 class="modal-title">✏️ Edit Attendance Record</h3>
      <button class="modal-close" (click)="closeEditModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
    
    <div class="modal-body">
      <form class="edit-form" (ngSubmit)="submitEditAttendance()">
        <div class="form-section">
          <h4>👤 Employee Information</h4>
          <div class="form-grid">
            <div class="form-group">
              <label for="employeeName">Employee Name</label>
              <input 
                type="text" 
                id="employeeName" 
                [(ngModel)]="editingAttendance.employeeName" 
                name="employeeName"
                readonly
                class="form-input readonly">
            </div>
            <div class="form-group">
              <label for="employeeId">Employee ID</label>
              <input 
                type="text" 
                id="employeeId" 
                [(ngModel)]="editingAttendance.employeeId" 
                name="employeeId"
                readonly
                class="form-input readonly">
            </div>
            <div class="form-group">
              <label for="department">Department</label>
              <select 
                id="department" 
                [(ngModel)]="editingAttendance.department" 
                name="department"
                class="form-select">
                <option value="Engineering">Engineering</option>
                <option value="Design">Design</option>
                <option value="Human Resources">Human Resources</option>
                <option value="Marketing">Marketing</option>
                <option value="Sales">Sales</option>
                <option value="Operations">Operations</option>
                <option value="Administration">Administration</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h4>📅 Attendance Details</h4>
          <div class="form-grid">
            <div class="form-group">
              <label for="month">Month</label>
              <select 
                id="month" 
                [(ngModel)]="editingAttendance.month" 
                name="month"
                class="form-select">
                <option value="January">January</option>
                <option value="February">February</option>
                <option value="March">March</option>
                <option value="April">April</option>
                <option value="May">May</option>
                <option value="June">June</option>
                <option value="July">July</option>
                <option value="August">August</option>
                <option value="September">September</option>
                <option value="October">October</option>
                <option value="November">November</option>
                <option value="December">December</option>
              </select>
            </div>
            <div class="form-group">
              <label for="year">Year</label>
              <input 
                type="number" 
                id="year" 
                [(ngModel)]="editingAttendance.year" 
                name="year"
                min="2020"
                max="2030"
                class="form-input">
            </div>
            <div class="form-group">
              <label for="totalWorkingDays">Total Working Days</label>
              <input 
                type="number" 
                id="totalWorkingDays" 
                [(ngModel)]="editingAttendance.totalWorkingDays" 
                name="totalWorkingDays"
                min="1"
                max="31"
                class="form-input">
            </div>
          </div>
        </div>

        <div class="form-section">
          <h4>📊 Attendance Statistics</h4>
          <div class="form-grid">
            <div class="form-group">
              <label for="presentDays">Present Days *</label>
              <input 
                type="number" 
                id="presentDays" 
                [(ngModel)]="editingAttendance.presentDays" 
                name="presentDays"
                required
                min="0"
                max="31"
                class="form-input">
            </div>
            <div class="form-group">
              <label for="absentDays">Absent Days *</label>
              <input 
                type="number" 
                id="absentDays" 
                [(ngModel)]="editingAttendance.absentDays" 
                name="absentDays"
                required
                min="0"
                max="31"
                class="form-input">
            </div>
            <div class="form-group">
              <label for="leaveDays">Leave Days *</label>
              <input 
                type="number" 
                id="leaveDays" 
                [(ngModel)]="editingAttendance.leaveDays" 
                name="leaveDays"
                required
                min="0"
                max="31"
                class="form-input">
            </div>
          </div>
        </div>

        <div class="form-section">
          <h4>⏰ Additional Details</h4>
          <div class="form-grid">
            <div class="form-group">
              <label for="lateArrivals">Late Arrivals</label>
              <input 
                type="number" 
                id="lateArrivals" 
                [(ngModel)]="editingAttendance.lateArrivals" 
                name="lateArrivals"
                min="0"
                class="form-input">
            </div>
            <div class="form-group">
              <label for="earlyDepartures">Early Departures</label>
              <input 
                type="number" 
                id="earlyDepartures" 
                [(ngModel)]="editingAttendance.earlyDepartures" 
                name="earlyDepartures"
                min="0"
                class="form-input">
            </div>
            <div class="form-group">
              <label for="lastAttendanceDate">Last Attendance Date</label>
              <input 
                type="date" 
                id="lastAttendanceDate" 
                [(ngModel)]="editingAttendance.lastAttendanceDate" 
                name="lastAttendanceDate"
                class="form-input">
            </div>
          </div>
        </div>

        <div class="form-section">
          <h4>📝 Notes</h4>
          <div class="form-group">
            <label for="notes">Additional Notes</label>
            <textarea 
              id="notes" 
              [(ngModel)]="editingAttendance.notes" 
              name="notes"
              rows="3"
              class="form-textarea"
              placeholder="Enter any additional notes about this attendance record..."></textarea>
          </div>
        </div>

        <div class="form-section">
          <h4>📈 Calculated Fields</h4>
          <div class="calculated-fields">
            <div class="calculated-item">
              <span class="calculated-label">Attendance Percentage:</span>
              <span class="calculated-value">{{ editingAttendance.attendancePercentage }}%</span>
            </div>
            <div class="calculated-item">
              <span class="calculated-label">Total Days:</span>
              <span class="calculated-value">{{ (editingAttendance.presentDays || 0) + (editingAttendance.absentDays || 0) + (editingAttendance.leaveDays || 0) }}</span>
            </div>
          </div>
        </div>
      </form>
    </div>
    
    <div class="modal-footer">
      <button class="modal-btn secondary" (click)="closeEditModal()" [disabled]="isSubmittingEdit">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
        Cancel
      </button>
      <button class="modal-btn reset" (click)="resetEditForm()" [disabled]="isSubmittingEdit">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
          <path d="M3 3v5h5"/>
        </svg>
        Reset
      </button>
      <button class="modal-btn primary" (click)="submitEditAttendance()" [disabled]="isSubmittingEdit">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 6L9 17l-5-5"/>
        </svg>
        {{ isSubmittingEdit ? 'Updating...' : 'Update Record' }}
      </button>
    </div>
  </div>
</div>

<!-- Add Attendance Modal -->
<div class="modal-overlay" *ngIf="showAddModal" (click)="closeAddModal()">
  <div class="modal-content edit-modal" (click)="$event.stopPropagation()" *ngIf="newAttendance">
    <div class="modal-header">
      <h3 class="modal-title">➕ Add Attendance Record</h3>
      <button class="modal-close" (click)="closeAddModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>

    <div class="modal-body">
      <form class="edit-form" (ngSubmit)="submitAddAttendance()">
        <div class="form-section">
          <h4>👤 Employee Information</h4>
          <div class="form-grid">
            <div class="form-group">
              <label for="addAttName">Employee Name *</label>
              <input type="text" id="addAttName" [(ngModel)]="newAttendance.employeeName" name="addAttName" class="form-input" required>
            </div>
            <div class="form-group">
              <label for="addAttId">Employee ID *</label>
              <input type="text" id="addAttId" [(ngModel)]="newAttendance.employeeId" name="addAttId" class="form-input" required>
            </div>
            <div class="form-group">
              <label for="addAttDept">Department</label>
              <select id="addAttDept" [(ngModel)]="newAttendance.department" name="addAttDept" class="form-select">
                <option value="Engineering">Engineering</option>
                <option value="Design">Design</option>
                <option value="Human Resources">Human Resources</option>
                <option value="Marketing">Marketing</option>
                <option value="Sales">Sales</option>
                <option value="Operations">Operations</option>
                <option value="Administration">Administration</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h4>📅 Period & Stats</h4>
          <div class="form-grid">
            <div class="form-group">
              <label for="addAttMonth">Month</label>
              <select id="addAttMonth" [(ngModel)]="newAttendance.month" name="addAttMonth" class="form-select">
                <option value="January">January</option>
                <option value="February">February</option>
                <option value="March">March</option>
                <option value="April">April</option>
                <option value="May">May</option>
                <option value="June">June</option>
                <option value="July">July</option>
                <option value="August">August</option>
                <option value="September">September</option>
                <option value="October">October</option>
                <option value="November">November</option>
                <option value="December">December</option>
              </select>
            </div>
            <div class="form-group">
              <label for="addAttYear">Year</label>
              <input type="number" id="addAttYear" [(ngModel)]="newAttendance.year" name="addAttYear" min="2020" max="2030" class="form-input">
            </div>
            <div class="form-group">
              <label for="addAttTwd">Total Working Days</label>
              <input type="number" id="addAttTwd" [(ngModel)]="newAttendance.totalWorkingDays" name="addAttTwd" min="1" max="31" class="form-input">
            </div>
            <div class="form-group">
              <label for="addAttPresent">Present Days</label>
              <input type="number" id="addAttPresent" [(ngModel)]="newAttendance.presentDays" name="addAttPresent" min="0" max="31" class="form-input" (ngModelChange)="recalcAddAttendance()">
            </div>
            <div class="form-group">
              <label for="addAttAbsent">Absent Days</label>
              <input type="number" id="addAttAbsent" [(ngModel)]="newAttendance.absentDays" name="addAttAbsent" min="0" max="31" class="form-input" (ngModelChange)="recalcAddAttendance()">
            </div>
            <div class="form-group">
              <label for="addAttLeave">Leave Days</label>
              <input type="number" id="addAttLeave" [(ngModel)]="newAttendance.leaveDays" name="addAttLeave" min="0" max="31" class="form-input" (ngModelChange)="recalcAddAttendance()">
            </div>
          </div>
        </div>

        <div class="form-section">
          <h4>📝 Notes</h4>
          <div class="form-group">
            <label for="addAttNotes">Additional Notes</label>
            <textarea id="addAttNotes" [(ngModel)]="newAttendance.notes" name="addAttNotes" rows="3" class="form-textarea"></textarea>
          </div>
        </div>

        <div class="form-section">
          <h4>📈 Calculated</h4>
          <div class="calculated-fields">
            <div class="calculated-item">
              <span class="calculated-label">Attendance %:</span>
              <span class="calculated-value">{{ newAttendance.attendancePercentage }}%</span>
            </div>
          </div>
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button class="modal-btn secondary" (click)="closeAddModal()" [disabled]="isSubmittingAdd">Cancel</button>
      <button class="modal-btn primary" (click)="submitAddAttendance()" [disabled]="isSubmittingAdd">{{ isSubmittingAdd ? 'Creating...' : 'Create Record' }}</button>
    </div>
  </div>
</div>
